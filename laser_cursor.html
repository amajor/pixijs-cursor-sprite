<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Laser Cursor</title>
    <script src="js/pixi.min.js"></script>
</head>

<body>
    <p><a href="./index.html">home</a></p>
    <h1>PIXI.js - Laser Cursor</h1>
    <script>
        // Create PIXI application and append it to the browser document body.
        const app = new PIXI.Application({ background: '#1099bb' });
        document.body.appendChild(app.view);

        // Set some constants
        const CURSOR_STYLE = "crosshair";
        const CENTER_X = app.view.width / 2;
        const CENTER_Y = app.view.height / 2;
        const USER_NAME = "Matt";
        const LASER_COLOR = "green";
        const TEXT_STYLE = {
            fontFamily: 'Arial',
            fontSize: 11,
            fill: '#000000', // gradient
        };

        // Provide CSS for the mouse pointer
        app.renderer.events.cursorStyles.default = CURSOR_STYLE;

        /****************************************************
         ** Create a container object for the laser cursor
         ****************************************************/
        const laserDetails = new PIXI.Container();
        app.stage.addChild(laserDetails);

        // Add the user icon to the laser details container
        const laserSprite = PIXI.Sprite.from('images/user_1.png');
        laserSprite.anchor.set(0.5);
        laserDetails.addChild(laserSprite);

        // Add the text to the laser details container 
        // https://pixijs.io/examples/#/text/text.js
        const textSprite = new PIXI.Text(`${USER_NAME}\n(${LASER_COLOR})`,
            {
                fontFamily: 'Arial',
                fontSize: 11,
                fill: '#000000', // gradient
            }
        );
        textSprite.anchor.set(0.5);
        laserDetails.addChild(textSprite);

        // Move container to the center
        laserDetails.x = CENTER_X;
        laserDetails.y = CENTER_Y;

        app.stage.addChild(laserDetails);

        /****************************************************
         ** Mouse Interactions
         ****************************************************/
        app.stage.interactive = true;

        // Watch pointer moves on the stage
        // TODO: Need another background object so our listener covers entire canvas
        app.stage.on("pointermove", moveLaserDetails);

        function moveLaserDetails(event) {
            let cursor_position = event.data.global;

            // Set the position of the user icon based on the cursor position
            laserDetails.x = cursor_position.x;
            laserDetails.y = cursor_position.y;
        }
    </script>
</body>

</html>